<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>SAE Ajax Course - Level 4</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>SAE Ajax</h1>
        <h2>Level 4 - Same Origin Policy</h2>
        <a href="https://github.com/antoinet/sae.ajax" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
			

          <h3><a id="exercise00" class="anchor" href="#exercise00" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 0 - Same Origin Policy</h3>
		  <p>
              As seen in the lecture, the Same Origin Policy (SOP) is a security mechanism that prevents third party sites to access (i.e. steal) sensitive data from your web application, such as cookies (e.g. PHPSESSID, JSESSIONID, etc.) or execute malicious javascript code. Here are some URLs loaded by the application. For each example, find out if the Same Origin Policy applies (i.e. the request is accepted) or not (i.e. the browser blocks the request):
        <table border="1">
            <tr><th>Script origin</th><th>Accessed Resource</th><th>PASS/BLOCK?</th></tr>
            <tr><td>http://www.foobar.com/js/blip.js</td><td>http://www.fubar.com/rest/userprofile/123</td><td></td></tr>
            <tr><td>https://www.foobar.com/js/blip.js</td><td>http://www.foobar.com/rest/userprofile/123</td><td></td></tr>
            <tr><td>https://www.foobar.com/js/blip.js</td><td>https://www.foobar.com/js/blap.js</td></td><td></td></tr>
            <tr><td>https://www.foobar.com/js/blip.js</td><td>https://www.foobar.com:8443/rest/userprofile/123</td><td></td></tr>
        </table>
		  </p>
			

            
          <h3><a id="exercise01" class="anchor" href="#exercise01" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 1 - Cross-Origin Request Blocked</h3>
		  <p>
              Download the file <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level04/exercise01.html">level04/exercise01.html</a> into your web server root and open the file through the browser. The page provides two buttons that will trigger AJAX requests to sites.
              <ol>
                <li>Requests from the first button fail. Figure out why. Have a look at the HTTP headers sent by the browser in the request. Is the HTTP header <code>Origin</code> set? Then have a look at the server response headers. Is the HTTP header <code>Access-Control-Allow-Origin</code> set?</li>
                <li>Now look at the second button. The requests succeed. Where is the difference to the first example? In the request headers from the browser, or in the response headers from the server?</li>
            </ol>
        Tip: use Firebug to analyse the HTTP traffic.
		  </p>

    
          <h3><a id="exercise02" class="anchor" href="#exercise02" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 2 - JSONP</h3>
		  <p>The goal of this exercise is to bypass the Same Origin Policy by dynamically creating a <code>&lt;script&gt;</code> using DOM. The URL given in the <code>src</code> attribute will be requested by the browser as soon as the DOM node is appended to the document. We can (ab-)use this to load a javascript file containing padded JSON data (so called JSONP). Therefore, it is necessary to declare a corresponding callback function in the HTML file.
              Download <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level04/exercise02.html">level04/exercise02.html</a> and <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level04/exercise02.php">level04/exercise02.php</a> into your web server root.
            <ol>
                <li>Implement the function <code>jsoncallback()</code>. Your code should extract the data values of the predefined object <code>o</code> and display them into the corresponding form fields in the HTML body.</li>
                <li>Implement the second function <code>jsonp()</code>. In there, you should dynamically create a <code>script</code> tag, set its <code>src</code> attribute to the php file (exercise02.php) and append the node to the body of the HTML file.</li>
            </ol>
    
    Hint: use the DOM functions <code>document.getElementById(...)</code>, <code>document.createElement(...)</code> and <code>document.appendChild(...)</code>.
		  </p>

          <h3><a id="exercise03" class="anchor" href="#exercise03" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 3 - JSONP Call to Flickr</h3>
		  <p>In this exercise, you will provide code to call the Flickr API with a JSONP call to retrieve photos that were tagged with <code>zurich</code>. Download <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level04/exercise03.html">level04/exercise03.html</a> into your web server root.
              
            <ol>
                <li>Have a look at the API specification for the corresponding method <a href="https://www.flickr.com/services/api/flickr.tags.getClusterPhotos.html">flickr.tags.getClusterPhotos</a>. Also, play around with the <a href="https://www.flickr.com/services/api/explore/flickr.tags.getClusterPhotos">API Explorer</a> to see how the response data is formatted (choose output: JSONP).</li>
                <li>Build the URL using the following format: (for details, see <a href="https://www.flickr.com/services/api/request.rest.html">REST request formats</a>)<br/><code>https://api.flickr.com/services/rest/?method=[METHOD]&api_key=[API-KEY]&tag=[TAG-NAME]&format=json&jsoncallback=[JSONP-CALLBACK-NAME]</code>. Use the following API key: <code>286a91389f0175f572466c707ba85df9</code>.</li>
                <li>Implement the function <code>create_script_tag()</code>, which dynamically creates a <code>script</code> tag. Set the <code>src</code> attribute to the above URL.</li>
                <li>Implement the callback function <code>jsonpcallback(...)</code>. Display the titles of the retrieved photos as <code>&lt;li&gt;</code> elements.</li>
            </ol>
            Hint: test the URL in your browser before coding. For more details about generating JSON in Flickr responses, see <a href="https://www.flickr.com/services/api/response.json.html#yui_3_11_0_1_1427300372762_253">JSON Response Format</a>.
		  </p>
			
            
        </section>

        <aside id="sidebar">
          <a href="https://github.com/antoinet/sae.ajax/raw/gh-pages/SAE_AJAX.ppt" class="button">
            <small>Download Slides</small>  
            .ppt file
          </a>
          <a href="https://github.com/antoinet/sae.ajax/zipball/master" class="button">
            <small>Download Exercises</small>
            .zip file
          </a>

          <p class="repo-owner"><a href="https://github.com/antoinet/sae.ajax"></a> is maintained by <a href="https://github.com/antoinet">antoinet</a>.</p>
		  
		  <h3>Level 1 - Warm Up</h3>
		  <ul>
			  <li><a href="level01.html#exercise00">Exercise 0</a></li>
			  <li><a href="level01.html#exercise01">Exercise 1</a></li>
  			  <li><a href="level01.html#exercise02">Exercise 2</a></li>
			  <li><a href="level01.html#exercise03">Exercise 3</a></li>
			  <li><a href="level01.html#exercise04">Exercise 4</a></li>  
		  </ul>
		  <h3>Level 2 - Working with DOM</h3>
		  <ul>
			  <li><a href="level02.html#exercise00">Exercise 0</a></li>
              <li><a href="level02.html#exercise01">Exercise 1</a></li>
              <li><a href="level02.html#exercise02">Exercise 2</a></li>
		  </ul>
		  <h3>Level 3 - The XMLHttpRequest Object</h3>
		  <ul>
			  <li><a href="level03.html#exercise00">Exercise 0</a></li>
              <li><a href="level03.html#exercise01">Exercise 1</a></li>
              <li><a href="level03.html#exercise02">Exercise 2</a></li>
              <li><a href="level03.html#exercise03">Exercise 3</a></li>
              <li><a href="level03.html#exercise04">Exercise 4</a></li>
              <li><a href="level03.html#exercise05">Exercise 5</a></li>
              <li><a href="level03.html#exercise06">Exercise 6</a></li>
              <li><a href="level03.html#exercise07">Exercise 7</a></li>
		  </ul>
          <h3>Level 4 - Same Origin Policy</h3>
          <ul>
              <li><a href="level04.html#exercise00">Exercise 0</a></li>
              <li><a href="level04.html#exercise01">Exercise 1</a></li>
              <li><a href="level04.html#exercise02">Exercise 2</a></li>
              <li><a href="level04.html#exercise03">Exercise 3</a></li>
          </ul>
          <h3>Level 5 - Apply your AJAX Knowledge</h3>
          <ul>
              <li><a href="level05.html#exercise00">Exercise 0</a></li>
          </ul>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
