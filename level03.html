<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>SAE Ajax Course - Level 3</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>SAE Ajax</h1>
        <h2>Level 3 - The XMLHttpRequest Object</h2>
        <a href="https://github.com/antoinet/sae.ajax" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
			

          <h3><a id="exercise00" class="anchor" href="#exercise00" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 0 - Inspecting the XMLHttpRequest Object</h3>
		  <p>
			  Let's have a closer look at the XMLHttpRequest object:
			  <ol>
				  <li>Open your browser's web development toolbar (e.g. Firebug) with the javascript console.</li>
				  <li>Create a new instance of XMLHttpRequest by typing: <code>xhr = new XMLHttpRequest()</code></li>
				  <li>Click on the resulting element, this will automatically switch to the DOM tab.</li>
				  <li>Identify the different members of the object: which elements are fields? Which are methods (i.e. functions)? And which are constants?</li>
			  </ol>
		  </p>


          <h3><a id="exercise01" class="anchor" href="#exercise01" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 1 - Hello, AJAX</h3>
		  
          <p>This exercise is the "Hello, World" of AJAX, in which you will code your very first AJAX request. Copy  <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise01.html">level03/exercise01.html</a> and <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise01.php">level03/exercise01.php</a> to your web root directory and write your code in the html file.
		  </p>
		  <p>
              <ol>
                  <li>Create a new XMLHttpRequest object.</li>
                  <li>Define the AJAX callback function, that will be called each time the XMLHttpRequest changes its internal state. Execute an <code>alert()</code> within the function.</li>
                  <li>Set the HTTP method and URL to call.</li>
                  <li>Execute the AJAX request.</li>
              </ol>
		  </p>
        <p>
            <ul>
                <li>Use the network tab of the web developer toolbar to debug your code. If everything is fine, you should see the requests everytime you click on the AJAX button.</li>
                <li>How many times does the alert pop up? Why?</li>
            </ul>
        </p>
          
			
          <h3><a id="exercise02" class="anchor" href="#exercise02" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 2 - HTTP Status Codes</h3>
		  
          <p>In this exercise, you will retrieve the HTTP status code, which indicates the result of the server processing the AJAX request. First, copy <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise02.html">level03/exercise02.html</a> and <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise02.php">level03/exercise02.php</a> to your web root directory.
		  </p>
		  <p>
              <ol>
                  <li>Open your browser's web developer toolbar (e.g. Firebug) with the network tab.</li>
                  <li>Open the html file and click on the AJAX button several times, look at the results in the network tab.</li>
                  <li>Locate the position in the javascript code where the AJAX call is processed. Insert code that will print the HTTP status code and HTTP status text in the span element with id <code>http_status</code>. Use the corresponding fields of the <code>XMLHttpRequest</code> object <code>status</code> and <code>statusText</code>.</li>
              </ol>
		  </p>
    <p>
        <ul>
            <li>Which HTTP status codes do you know of?</li>
            <li>Which is by far the most popular one?</li>
            <li>What is HTTP status code 418?</li>
        </ul>
    </p>
			  
			  
          <h3><a id="exercise03" class="anchor" href="#exercise03" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 3 - XMLHttpRequest ReadyState</h3>			  
<p>As seen earlier, the callback function defined in <code>onreadystatechange</code> gets called multiple times during each AJAX request. In this exercise, write code that displays the current <code>readyState</code> each time the function is called. Copy the files <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise03.html">level03/exercise03.html</a> and <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise03.php">level03/exercise03.php</a> to your web root and edit the HTML file.
              <ol>
                  <li>First, when clicking on the AJAX button, delete all div elements with class <code>readystate</code>.</li>
                  <li>Each time the AJAX callback function is called, append a new element to the div with id <code>readystatelist</code> with the value of the XMLHttpRequest's <code>readyState</code> field. (Bonus points: in addition to the numeric value of <code>readyState</code>, print its corresponding state name, i.e. UNSENT, OPENED, HEADERS_RECEIVED, LOADING and DONE).</li>
              </ol>
		  </p>

          <h3><a id="exercise04" class="anchor" href="#exercise04" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 4 - Displaying a Throbber</h3>			  
		  <p>A throbber is an animated graphic that visualizes that the application is performing an action in the background. For example, the website is loading data from the server, which may take a while. This is a very common pattern in connection with AJAX and a necessity for good user-experience.</p><p>In this exercise, you will implement a simple AJAX call, during processing time, a throbber is displayed. After the request has finished, remove the throbber and replace it with the string "done". Copy the files <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise04.html">level03/exercise04.html</a> and <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise04.php">level03/exercise04.php</a> to your web root and edit the HTML file.</p><p>Hint: You can generate nice throbbers from <a href="http://www.ajaxload.info/">ajaxload.info</a>.</p>


          <h3><a id="exercise05" class="anchor" href="#exercise05" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 5 - Processing Server Text Responses</h3>	
<p>In this exercise, you will issue an AJAX request and retrieve the server response, which you will display on the page. The template files <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise05.html">level03/exercise05.html</a> and <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise05.php">exercise05.php</a> contain a javascript function that is called when the user scrolls down to the end of the page. The goal of the exercise is to load additional content from the server when this occurs.
    <ol>
        <li>Locate the spot in the HTML file that you'll have to fill in with your code.</li>
        <li>Create a new XMLHttpRequest object and initialize it appropriately (think of the four necessary steps). The target URL is <code>exercise05.php</code>.</li>
        <li>Retrieve the data returned by the server in the AJAX response with the field <code>xhr.responseText</code>.</li>
        <li>Each time, append the new data to the div with id "wrap".</li>
    </ol>
		  </p>



          <h3><a id="exercise06" class="anchor" href="#exercise06" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 6 - Processing Server XML Responses</h3>	
		  <p>In this exercise, you will receive an XML structure from the server containing data about music albums. The goal is to retrieve the data and display it as a HTML table on the page.
            <ol>
                <li>First, download <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise06.html">level03/exercise06.html</a>, <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise06.php">level03/exercise06.php</a> and <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise06.xml">level03/exercise06.xml</a> and copy those files to your web root directory.</li>
                <li>Have a look at the XML data returned by the server (the PHP file) and analyse the data structure.</li>
                <li>Retrieve the XML data using <code>xhr.responseXML</code> and store it into a variable. The result is not a string, it is an XML-DOM structure.</li>
                <li>The nodes in the XML-DOM tree are accessible in a similar way than HTML DOM. You can use methods such as <code>getElementsByTagName()</code> (returns an array), <code>firstChild()</code>, <code>nodeValue</code>, etc.</li>
                <li>Create a table with 3 columns. The rows should contain the artist's name, the album name and the release year for each CD.</li>
            </ol>
            Hint: you don't have to create each table element manually using <code>document.createElement()</code>, instead, you can use <code>innerHTML</code>.
		  </p>


          <h3><a id="exercise07" class="anchor" href="#exercise07" aria-hidden="true"><span class="octicon octicon-link"></span></a>Exercise 7 - Processing Server JSON Responses</h3>	
<p>In this exercise, you will process JSON data originating from the social media platform <i>flickr</i>. The PHP code will provide you with the result of the <code>flickr.photos.getRecent</code> API call, which returns a set of most recent photos uploaded on flickr. The goal is parse the JSON data, extract the photo urls and create corresponding <code>&lt;img&gt;</code> tags to display all photos. Download the following files: <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise07.html">level03/exercise07.html</a>, <a href="https://raw.githubusercontent.com/antoinet/sae.ajax/master/level03/exercise07.php">level03/exercise07.php</a>.
    <ul>
        <li>First, have a look at the description of the <a href="https://www.flickr.com/services/api/flickr.photos.getRecent.html">Flickr API flickr.photos.getRecent</a> API call on flickr.</li>
        <li>To analyse the returned JSON structure, look at the result of the API by calling the PHP file in your browser. You may want to use an Addon like <a href="http://jsonview.com">JSONView</a> for this task.</li>
        <li>Within the AJAX callback in the HTML file, write code to read in the JSON structure. The response body from the server can be retrieved from <code>xhr.responseText</code>. To convert this string value to a JSON structure, use <code>JSON.parse(...)</code>.</li>
    </ul>
</p>



        </section>

        <aside id="sidebar">
          <a href="https://github.com/antoinet/sae.ajax/raw/gh-pages/SAE_AJAX.ppt" class="button">
            <small>Download Slides</small>  
            .ppt file
          </a>
          <a href="https://github.com/antoinet/sae.ajax/zipball/master" class="button">
            <small>Download Exercises</small>
            .zip file
          </a>

          <p class="repo-owner"><a href="https://github.com/antoinet/sae.ajax"></a> is maintained by <a href="https://github.com/antoinet">antoinet</a>.</p>
		  
		  <h3>Level 1 - Warm Up</h3>
		  <ul>
			  <li><a href="level01.html#exercise00">Exercise 0</a></li>
			  <li><a href="level01.html#exercise01">Exercise 1</a></li>
  			  <li><a href="level01.html#exercise02">Exercise 2</a></li>
			  <li><a href="level01.html#exercise03">Exercise 3</a></li>
			  <li><a href="level01.html#exercise04">Exercise 4</a></li>  
		  </ul>
		  <h3>Level 2 - Working with DOM</h3>
		  <ul>
			  <li><a href="level02.html#exercise00">Exercise 0</a></li>
              <li><a href="level02.html#exercise01">Exercise 1</a></li>
              <li><a href="level02.html#exercise02">Exercise 2</a></li>
		  </ul>
		  <h3>Level 3 - The XMLHttpRequest Object</h3>
		  <ul>
			  <li><a href="level03.html#exercise00">Exercise 0</a></li>
              <li><a href="level03.html#exercise01">Exercise 1</a></li>
              <li><a href="level03.html#exercise02">Exercise 2</a></li>
              <li><a href="level03.html#exercise03">Exercise 3</a></li>
              <li><a href="level03.html#exercise04">Exercise 4</a></li>
              <li><a href="level03.html#exercise05">Exercise 5</a></li>
              <li><a href="level03.html#exercise06">Exercise 6</a></li>
              <li><a href="level03.html#exercise07">Exercise 7</a></li>
		  </ul>
          <h3>Level 4 - Same Origin Policy</h3>
          <ul>
              <li><a href="level04.html#exercise00">Exercise 0</a></li>
          </ul>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
